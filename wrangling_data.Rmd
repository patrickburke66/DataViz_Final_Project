---
title: "Wrangling Data"
author: "Patrick Burke"
date: "3/21/2022"
output: html_document
---

        #(p("This is an app to test out different combinations for Mario Kart 8 deluxe. In this app, you can select your Character, Kart, Tires, and Glider on the left hand side. Each of our different tabs includes statistics and information about your selection. You can also navigate to the Random Kart selector. All Mario Kart statistics have a minimum of 0.75 and a maximum of 5.75. All of the characters begin with base statistics. Changing the Kart, Tires, or Glider changes can effect each of these statistics positively or negatively. Enjoy!")
         #)


```{r}
library(tidyverse)
library(rvest)
##install.packages("shinythemes")
library(shinythemes)
##install.packages("janitor")
library(janitor)
```

## World record scraping

```{r}
url2 <- "https://mkwrs.com/mk8dx/wrs.php?date=0"
wr <- read_html(url2)
wr_tab <- wr %>% html_nodes("table")
```

```{r}
worldrecords <- wr_tab[[2]] %>% html_table()

worldrecords <- worldrecords %>%
  subset(select = (-c(4,11)))
```

## Found some new datasets. Possibly better?
```{r}
bodiesNew <- read_csv("bodies.csv")
bodiesNew <- bodiesNew %>%
  mutate(Karts = Body) %>%
  subset(select = (-c(2)))


tiresNew <- read_csv("tires.csv")
tiresNew <- tiresNew %>%
  mutate(Tires = Body) %>%
  subset(select = (-c(2)))

glidersNew <- read_csv("gliders.csv")
glidersNew <- glidersNew %>%
  mutate(Gliders = Body) %>%
  subset(select = (-c(2)))

charactersNew <- read_csv("characters.csv")


mkfullNew <- full_join(bodiesNew, charactersNew)
mkfullNew <-full_join(mkfullNew, glidersNew)
mkfullNew <- full_join(mkfullNew, tiresNew)

selected <- mkfullNew %>%
  filter(Karts == "Standard Kart" | Character == "Mario" |
         Gliders == "Super" | Tires == "Standard")

finalstats <- data.frame(t(colSums(selected[2:13])))
  
finalstats <- finalstats %>%
  pivot_longer(cols = c(1:12), names_to = "Stats", values_to = "Rating") 

colnames(mkfullNew)<- c("Type", "Total Speed","Water Speed", "Air Speed",
                        "Ground Speed", "Acceleration", "Weight", "Total Handling",
                        "Water Handling","Air Handling", "Ground Handling", "Traction",
                        "Mini Turbo","Karts", "Class", "Character", "Gliders", "Tires")

finalstats <- finalstats %>%
  mutate(Stats = as.factor(Stats))

finalstats <- finalstats %>%
  fct_relevel(.f = Stats, levels = "Speed", "Acceleration", "Weight", "Handling",
              "Traction", "Mini.Turbo", 
              "Speed..Water.", "Speed..Air.", "Speed..Ground.", 
              "Handling..Water.", "Handling..Air.", "Handling.Ground.")

write.csv(worldrecords, file = "worldrecords.csv")
```




